# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовые классы и их предназначение

## 1.1. Класс EventEmitter

Назначение:
Обеспечивает работу событийного механизма. Позволяет компонентам подписываться на события, отписываться от них и вызывать соответствующие обработчики.

Функции:

on<T extends object>(event: EventName, callback: (data: T) => void): void; — подписка на событие.

emit<T extends object>(event: string, data?: T): void; — вызов обработчиков при возникновении события.

trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void; - создаёт функцию-триггер, которая при вызове будет генерировать событие event и объединять данные data с context

## 1.2. Класс ModalWindow

Назначение:
Управление модальными окнами на всех страницах приложения.

Функции:

open(content: Component): void — открытие модального окна с заданным контентом.

close(): void — закрытие окна (реагирует как на клик вне окна, так и на нажатие на иконку закрытия).

Обработка событий закрытия окна.

## 1.3. Класс CartService

Назначение:
Управление состоянием корзины (добавление, удаление, очистка товаров).

Функции:

addProduct(product: Product): void — добавление товара в корзину (если товар ещё не добавлен).

removeProduct(productId: string): void — удаление товара из корзины.

getProducts(): Product[] — получение списка товаров в корзине.

clearCart(): void — очистка корзины (после успешной оплаты).

## 1.4. Класс OrderController

Назначение:
Управление процессом оформления заказа, валидация данных и взаимодействие с сервисами оплаты.

Функции:

validateStepOne(paymentMethod: string, address: string): boolean — валидация первого шага (проверка выбора способа оплаты и наличия адреса).

validateStepTwo(email: string, phone: string): boolean — валидация второго шага (проверка заполненности контактных данных).

submitOrder(orderData: Order): Promise<void> — отправка заказа (симуляция оплаты) и последующее очищение корзины при успехе.

## 2. Компоненты и их связи

## 2.1. Компонент Catalog

Функции:

Отображение каталога товаров.

При клике на карточку товара – инициирует открытие модального окна с детальной информацией.

Связи:

Использует компонент ProductCard для каждого товара.

Взаимодействует с ModalWindow через событие клика для открытия детальной информации.

## 2.2. Компонент ProductCard

Функции:

Отображение краткой информации о товаре.

Отслеживание клика для открытия детального просмотра.

Связи:

При клике отправляет событие, которое перехватывается Catalog или ModalWindow для показа детальной информации.

## 2.3. Компонент ProductDetailModal

Функции:

Отображение детальной информации о товаре.

Кнопка «В корзину» добавляет товар в корзину (с помощью CartService), кнопка «Убрать» удаляет товар.

Связи:

Встраивается в ModalWindow.

Взаимодействует с CartService для изменения состояния корзины.

## 2.4. Компонент Cart

Функции:

Отображение товаров, добавленных в корзину.

Обеспечение возможности удаления товара из корзины.

Связи:

Получает данные из CartService.

При изменении корзины инициирует события для обновления отображения.

## 2.5. Компонент Checkout

Функции:

Разбит на два шага:
Шаг 1: Выбор способа оплаты и ввод адреса доставки (с валидацией обязательного поля адреса).
Шаг 2: Ввод почты и телефона покупателя (с валидацией обязательных полей).

Управление состоянием перехода между шагами (кнопка «Далее» становится активной только при выполнении требований текущего шага).

Связи:

Взаимодействует с OrderController для валидации данных и отправки заказа.

При успешном завершении заказа инициирует событие очистки корзины через CartService.

## 2.6. Компонент Button

Функции:

Универсальный компонент для кнопок, который может менять состояние (активное/неактивное) в зависимости от выполнения условий.

Связи:

Используется во всех компонентах (например, в Checkout для перехода к следующему шагу или оплаты, в ProductDetailModal для кнопок «В корзину» и «Убрать»).

## 3 Взаимодействие частей и поток управления

1. Пользователь заходит на главную страницу (Catalog):

Компонент Catalog получает список товаров и отображает их с помощью ProductCard.

2. Просмотр товара:

При клике на карточку товара срабатывает событие, которое инициирует открытие ModalWindow с компонентом ProductDetailModal.

В ProductDetailModal пользователь может добавить или убрать товар, что вызывает методы CartService.

3. Просмотр корзины:

По клику на иконку корзины открывается компонент Cart, который считывает текущее состояние корзины из CartService.

4. Оформление заказа:

Пользователь переходит к компоненту Checkout.

На первом шаге вводится способ оплаты и адрес доставки; OrderController проверяет корректность введённых данных.

При успешной валидации кнопка для перехода к следующему шагу активируется.

На втором шаге вводятся почта и телефон; после проверки, при нажатии на кнопку оплаты, OrderController инициирует процесс оплаты, выводит сообщение об успехе и вызывает метод clearCart() в CartService для очистки корзины.

5. Событийная модель:

Компоненты обмениваются сообщениями через EventEmitter, например, при добавлении товара в корзину, изменении состояния заказа или закрытии модальных окон.
